@import "../../style/base";

$progress-spinner-stroke-width: 10%;
$progress-spinner-size: #{size(48)};
$progress-spinner-indeterminate-container-duration: 2s;
$progress-spinner-indeterminate-progress-duration: 4s;

:host {
	width: #{$progress-spinner-size};
	height: #{$progress-spinner-size};

	contain: strict;
	position: relative;
	display: inline-block;
}

svg {
	width: 100%;
	height: 100%;
	position: absolute;
	transform: rotate(-90deg);
	top: 0;
	left: 0;
	transform-origin: center center;
	overflow: visible;
}

#progress, #buffer {
	stroke-width: var(--progress-spinner-stroke-width, #{$progress-spinner-stroke-width});
	stroke-dasharray: 285px;
	transition-property: stroke;
	transform-origin: center;
}

#buffer {
	stroke: var(--progress-spinner-buffer-color, #{color("primary", 500, 0.2)});
}

#progress {
	stroke: var(--progress-spinner-color, #{color("primary")});
}

:host([mode="indeterminate"]) {
	svg {
		animation: rotate var(--progress-spinner-indeterminate-container-duration, #{$progress-spinner-indeterminate-container-duration}) linear infinite;
	}

	#progress {
		animation-duration: var(--progress-spinner-indeterminate-progress-duration, #{$progress-spinner-indeterminate-progress-duration});
		animation-timing-function: var(--progress-spinner-indeterminate-timing-function, #{$transition-standard-curve});
		animation-iteration-count: infinite;
		animation-name: indeterminate;
	}

}

:host([mode="determinate"]) #progress, #buffer {
	transition: var(--progress-spinner-determinate-progress-transition, stroke-dashoffset #{$transition-linear});
}

@keyframes rotate {
	0% {
		transform: rotate(0);
	}
	100% {
		transform: rotate(360deg);
	}
}

@keyframes indeterminate {
	0% {
		stroke-dashoffset: 268px;
		transform: rotate(0);
	}
	12.5% {
		stroke-dashoffset: 56px;
		transform: rotate(0);
	}
	12.5001% {
		stroke-dashoffset: 56px;
		transform: rotateX(180deg) rotate(72.5deg);
	}
	25% {
		stroke-dashoffset: 268px;
		transform: rotateX(180deg) rotate(72.5deg);
	}
	25.0001% {
		stroke-dashoffset: 268px;
		transform: rotate(270deg);
	}
	37.5% {
		stroke-dashoffset: 56px;
		transform: rotate(270deg);
	}
	37.5001% {
		stroke-dashoffset: 56px;
		transform: rotateX(180deg) rotate(161.5deg);
	}
	50% {
		stroke-dashoffset: 268px;
		transform: rotateX(180deg) rotate(161.5deg);
	}
	50.0001% {
		stroke-dashoffset: 268px;
		transform: rotate(180deg);
	}
	62.5% {
		stroke-dashoffset: 56px;
		transform: rotate(180deg);
	}
	62.5001% {
		stroke-dashoffset: 56px;
		transform: rotateX(180deg) rotate(251.5deg);
	}
	75% {
		stroke-dashoffset: 268px;
		transform: rotateX(180deg) rotate(251.5deg);
	}
	75.0001% {
		stroke-dashoffset: 268px;
		transform: rotate(90deg);
	}
	87.5% {
		stroke-dashoffset: 56px;
		transform: rotate(90deg);
	}
	87.5001% {
		stroke-dashoffset: 56px;
		transform: rotateX(180deg) rotate(341.5deg);
	}
	100% {
		stroke-dashoffset: 268px;
		transform: rotateX(180deg) rotate(341.5deg);
	}
}
